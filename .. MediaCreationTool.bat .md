![Preview1](https://i.imgur.com/EEQbC2k.png)

>Hello! I bring news. Beside the introduction of **21H1 MCT** ;)  
![Preview2](https://i.imgur.com/dHYAHiT.png)

>**First, I have added create media preset(s) that when used, will send you right at the select usb or save iso dialog.**  
>And when booting from the media, the pick edition dialog will be skipped.  
>The attempts I've seen in this thread were mostly failing because /Pkey option is only meant for retail bought keys, not for generic / hwid!  
>To overcome this limitation script simply generates a `PID.txt` with the key you provide and  then adds it to the media `sources` folder.  

>**Second, I have reworked the auto upgrade preset (actually more like reverted it to how it was intended initially)**.  
>The notable change is that the script now has to take the initiative and ask for admin rights itself.  
>That's so it can wait in the background for MCT to finish the first phase of creating upgrade media.  
>Once that's done, it will launch setupprep for the second phase (via auto.cmd) and then quit.  
>This allows a seamless upgrade experience with no intermediary prompts.  

>As a bonus, you can set lang, edition, arch, key to upgrade to a different edition than the current one!  
>_I have done plenty of such upgrades today going forward and backward from/to 20H1/20H2/21H1 switching edition several times - since all have the same 19041 base, means you get full upgrade with files, apps and settings saved (if lang and arch are compatible)._  

>Try it out just by renaming the script to `auto MediaCreationTool.bat` - by default starts upgrade to 21H1  
>Can also add the numeric version target: `auto 2004 MediaCreationTool.bat` or `auto 2009 MediaCreationTool.bat`   

>**For those that use the script _as-is_, these enhancements do not affect the workflow in any way.**  
>Script will simply pass control to MCT and quit early as before.

```
2018.10.10: reinstated 1809 [RS5]! using native xml patching for products.xml; fixed syntax bug with exit/b
2018.10.12: added data loss warning for RS5
2018.11.13: RS5 is officially back! + greatly improved choices dialog - feel free to use the small snippet in your own scripts
2019.05.22: 1903 [19H1]
2019.07.11: 1903 __release_svc_refresh__ and enable DynamicUpdate by default to grab latest CU
2019.09.29: UPDATED 19H1 build 18362.356 ; RS5 build 17763.379 and show build number
            added LATEST MCT choice to dinamically download the current version (all others have hard-coded links)
2019.11.16: 19H2 18363.418 as default choice (updated hard-coded links)
2020.02.29: 19H2 18363.592
2020.05.28: 2004 19041.264 first release
2020.10.29: 20H2 and aniversary script refactoring to support all MCT versions from 1507 to 20H2!!!
2020.10.30: hotfix utf-8, enterprise on 1909+
2020.11.01: fix remove unsupported options in older versions code breaking when path has spaces.. pff
2020.11.14: generate latest links for 1909,2004; all xml editing now in one go; resolved known cannot run script issues
2020.11.15: one-time clear of cached MCT, as script generates proper 1.0 catalog for 1507,1511,1703 since last update
            fixed compatibility with naked windows 7 powershell 2.0 / IPv6 / optional import $OEM$ / 1803+ business typo
            updated executables links for 1903 and 2004
2020.11.17: parse first commandline parameter as version, example: MediaCreationTool.bat 1909
2020.12.01: attempt to fix reported issues with 1703; no other changes (skipping 19042.630 leaked esd because it is broken)
2020.12.11: 20H2 19042.631; fixed pesky 1703 decryption bug on dual x86 + x64; improved cleanup; label includes version  
2021.03.20: pre-release 21H1; optional auto upgrade or create media presets importing $OEM$ folder and key as PID.txt
```